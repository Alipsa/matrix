# matrix-arff v0.1.0 Roadmap

This roadmap captures fixes and improvements identified from reviewing the matrix-arff module, with a focus on correctness, input API alignment, and better ARFF compliance.

## Overview

The matrix-arff module currently supports File/Path/InputStream/URL reads and File/Path/OutputStream/Writer writes. It parses a subset of ARFF, but has gaps around validation, input API parity with other modules, and escaping/quoting edge cases.

## Issues & Improvements

### 1. Input API alignment with matrix-csv/json/parquet
matrix-csv and matrix-json expose File/Path/InputStream/Reader/URL plus string convenience overloads. matrix-parquet adds file-path and URL string convenience methods. matrix-arff is missing several of these and has limited validation.

1.1 [x] Add reader overloads for `Reader`, `String` content, `readFromFile(String)`, and `readFromUrl(String)`
1.2 [x] Add validation for null inputs, missing files, and directory inputs (mirror matrix-parquet validation style)
1.3 [x] Normalize default matrix name for File/Path/URL inputs to base name without extension (align with CSV/Parquet)
1.4 [x] Document the expanded input support in module docs or class GroovyDoc

### 2. Escaping/quoting correctness
The writer escapes single quotes with backslashes, but the reader does not unescape them. Quoted identifiers and quoted string/nominal values lose escaping fidelity, and the CSV parser does not handle escaped quotes.

2.1 [x] Add unescape handling for quoted identifiers, nominal values, and string values
2.2 [x] Upgrade CSV parsing logic to handle escaped quotes/backslashes inside quoted values
2.3 [x] Preserve leading/trailing whitespace in quoted values (avoid blind `.trim()` for quoted content)
2.4 [x] Add explicit tests covering quoted identifiers, escaped quotes, and comma-in-value scenarios

### 3. Integer/Long/BigInteger handling
Writer maps Long/BigInteger columns to `INTEGER`, but reader maps `INTEGER` to Integer, risking overflow and type loss.

3.1 [x] Decide on consistent mapping (e.g., map `INTEGER` to Long, or write Long/BigInteger as NUMERIC)
3.2 [x] Update writer/reader behavior to match the chosen mapping
3.3 [x] Add tests for Long/BigInteger round-trip or documented coercion behavior

### 4. Validation and robustness
The writer and reader lack null/empty validations and have minor inconsistencies (duplicate `value == '?'` check, UTF-8 string literal usage).

4.1 [x] Add matrix/file validation to writer methods (null matrix, empty columns, null output)
4.2 [x] Consolidate the duplicate missing-value check (`value == '?'` repeated)
4.3 [x] Prefer `StandardCharsets.UTF_8` over string literal for charset usage

### 5. Tests
Ensure coverage for new inputs and edge cases.

5.1 [x] Add tests for new input overloads (Reader, String content, readFromFile, readFromUrl)
5.2 [x] Add tests for escaping/unescaping of attribute names and data values
5.3 [x] Add tests for Long/BigInteger behavior
5.4 [x] Run `./gradlew :matrix-arff:test`

## Notes

- Keep ARFF parsing behavior consistent with existing tests unless explicitly updated.
- If changes affect parsing output, update or add tests accordingly.
- Document any behavior changes in GroovyDoc or a module README if created.
