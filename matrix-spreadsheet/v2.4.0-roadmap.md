# Matrix Spreadsheet v2.4.0 Release Roadmap

This document outlines the planned work for matrix-spreadsheet v2.4.0.

## Summary

v2.4.0 focuses on targeted refactoring, stronger test coverage (>= 70%),
performance benchmarking, and release hygiene.

---

## Priority 1: Testing & Performance (Must Do)

### 1.1 [ ] Test coverage plan (target >= 70%)
- See the detailed plan in v2.3.0 roadmap under "Test Coverage & Performance Plan".

### 1.2 [ ] Add performance benchmarks for XLSX/ODS read/write
- Baseline read/write timing for realistic datasets and document results.

### 1.3 [ ] Fix any performance regressions found in benchmarks
- Capture before/after metrics in the benchmark output log.

---

## Priority 2: Refactoring (Should Do)

### 2.1 [ ] Consider splitting FExcelAppender
- **File**: `src/main/groovy/se/alipsa/matrix/spreadsheet/fastexcel/FExcelAppender.groovy`
- **Issue**: ~750 lines with 11 inner classes
- **Consideration**: Could extract `WorkbookState`, `WorkbookPlan`, `SheetTemplate` to separate files
- **Note**: The class is well-structured internally; this is optional cleanup

### 2.2 [ ] Consider using Optional<Integer> in FExcelReader
- **File**: `src/main/groovy/se/alipsa/matrix/spreadsheet/fastexcel/FExcelReader.groovy`
- **Issue**: Returns -1 when sheet/content not found (lines 85, 97, 146)
- **Consideration**: Modern Java practice would use Optional<Integer>
- **Note**: This is a breaking API change; defer to v3.0 if needed

### 2.3 [ ] Consider more specific exception types in FileUtil
- **File**: `src/main/groovy/se/alipsa/matrix/spreadsheet/FileUtil.groovy`
- **Issue**: Throws generic `Exception` in several places
- **Note**: Low priority; current behavior works

---

## Priority 3: Release Checklist

- [ ] Remove SNAPSHOT suffix from build.gradle version when cutting release

